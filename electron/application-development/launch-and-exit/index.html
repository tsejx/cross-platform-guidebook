<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/cross-platform-guidebook/umi.css" />
    <script>
      window.routerBase = "/cross-platform-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.14
    </script>
    <title>&#x751F;&#x547D;&#x5468;&#x671F;</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/cross-platform-guidebook-favicon.svg&#x27;)" href="/cross-platform-guidebook//">Cross Platform Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/cross-platform-guidebook//hybird">Hybrid</a><a href="/cross-platform-guidebook//mini-program">小程序</a><a href="/cross-platform-guidebook//react-native">ReactNative</a><a href="/cross-platform-guidebook//flutter">Flutter</a><a aria-current="page" class="active" href="/cross-platform-guidebook//electron">Electron</a><a href="/cross-platform-guidebook//pwa">PWA</a><a href="/cross-platform-guidebook//open-source">扩展</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/cross-platform-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/cross-platform-guidebook-favicon.svg&#x27;)" href="/cross-platform-guidebook//"></a><h1>Cross Platform Guidebook</h1><p>跨平台开发完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/cross-platform-guidebook//hybird">Hybrid</a></li><li><a href="/cross-platform-guidebook//mini-program">小程序</a></li><li><a href="/cross-platform-guidebook//react-native">ReactNative</a></li><li><a href="/cross-platform-guidebook//flutter">Flutter</a></li><li><a aria-current="page" class="active" href="/cross-platform-guidebook//electron">Electron</a></li><li><a href="/cross-platform-guidebook//pwa">PWA</a></li><li><a href="/cross-platform-guidebook//open-source">扩展</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/cross-platform-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/cross-platform-guidebook//electron">Electron</a></li><li><a href="/cross-platform-guidebook//electron/main-process">主进程模块</a><ul><li><a href="/cross-platform-guidebook//electron/main-process/overview"><span>Main Process</span></a></li></ul></li><li><a href="/cross-platform-guidebook//electron/render-process">渲染进程模块</a><ul><li><a href="/cross-platform-guidebook//electron/render-process/overview"><span>Renderer Process</span></a></li></ul></li><li><a aria-current="page" class="active" href="/cross-platform-guidebook//electron/application-development">应用开发</a><ul><li><a href="/cross-platform-guidebook//electron/application-development/compile"><span>编译打包</span></a></li><li><a href="/cross-platform-guidebook//electron/application-development/deploy"><span>应用部署</span></a></li><li><a aria-current="page" class="active" href="/cross-platform-guidebook//electron/application-development/launch-and-exit"><span>生命周期</span></a></li></ul></li><li><a href="/cross-platform-guidebook//electron/other">Other</a><ul><li><a href="/cross-platform-guidebook//electron/other/community"><span>社区精选资源</span></a></li><li><a href="/cross-platform-guidebook//electron/other/compose"><span>桌面端技术选型分析</span></a></li><li><a href="/cross-platform-guidebook//electron/other/process-model"><span>流程模型</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="退出场景" data-depth="2" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#退出场景"><span>退出场景</span></a></li><li title="正常退出" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#正常退出"><span>正常退出</span></a></li><li title="异常退出" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#异常退出"><span>异常退出</span></a></li><li title="SIG 信号退出" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#sig-信号退出"><span>SIG 信号退出</span></a></li><li title="启动场景" data-depth="2" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#启动场景"><span>启动场景</span></a></li><li title="普通启动" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#普通启动"><span>普通启动</span></a></li><li title="单例模式下的应用启动" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#单例模式下的应用启动"><span>单例模式下的应用启动</span></a></li><li title="通过命令行启动" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#通过命令行启动"><span>通过命令行启动</span></a></li><li title="通过 URL Scheme 启动" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#通过-url-scheme-启动"><span>通过 URL Scheme 启动</span></a></li><li title="通过拖拽到 dock 或者 tray 启动" data-depth="3" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#通过拖拽到-dock-或者-tray-启动"><span>通过拖拽到 dock 或者 tray 启动</span></a></li><li title="参考资料" data-depth="2" class=""><a href="/cross-platform-guidebook//electron/application-development/launch-and-exit#参考资料"><span>参考资料</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="生命周期"><a aria-hidden="true" href="#生命周期"><span class="icon icon-link"></span></a>生命周期</h1><h2 id="退出场景"><a aria-hidden="true" href="#退出场景"><span class="icon icon-link"></span></a>退出场景</h2><h3 id="正常退出"><a aria-hidden="true" href="#正常退出"><span class="icon icon-link"></span></a>正常退出</h3><ul><li><code>Command + Q</code> 或者菜单中的退出按钮，Windows 中 <code>Alt + F4</code></li><li><code>app.quit()</code></li><li><code>autoupdater.quitAndInstall()</code></li><li><code>app.reluanch()</code></li></ul><h3 id="异常退出"><a aria-hidden="true" href="#异常退出"><span class="icon icon-link"></span></a>异常退出</h3><p>比如常见的在主进程调用 <code>process.crash()</code></p><h3 id="sig-信号退出"><a aria-hidden="true" href="#sig-信号退出"><span class="icon icon-link"></span></a>SIG 信号退出</h3><p>我们常见的命令行退出软件的方式有 <code>Ctrl + C</code>，命令行给进程发送了 <code>SIGKILL</code> 信号，其实还有其它常见关闭进程的方式，可以通过 <code>kill</code> 对进程发送信号，比如 <code>kill -s KILL 24567</code> 或者 <code>kill -9 24567</code>。</p><h2 id="启动场景"><a aria-hidden="true" href="#启动场景"><span class="icon icon-link"></span></a>启动场景</h2><p>软件常见的启动有很多，比如通过 <code>open</code> 或者 Windows 的 <code>start</code> 启动，或者通过 URL Scheme 然后系统启动，或者拖动文档到 Dock 或者 Tray 启动。下面来说说启动软件后，软件参数和环境的路径。</p><h3 id="普通启动"><a aria-hidden="true" href="#普通启动"><span class="icon icon-link"></span></a>普通启动</h3><p>一般双击软件启动，会经过 <code>will-finish-launching</code> 和 <code>ready</code>，然后正常进入应用界面。</p><h3 id="单例模式下的应用启动"><a aria-hidden="true" href="#单例模式下的应用启动"><span class="icon icon-link"></span></a>单例模式下的应用启动</h3><p>在应用启动的时候，检测 <code>app.requestSingleInstanceLock()</code> 是否是单例模式，如果是就退出，并且发送一个事件给 <code>second-instance</code>，从这里再获取退出的应用的 <code>argv</code> 和 <code>cwd</code>。</p><p>其实这里检测是否是单例模式的方法是，看看 <code>app.getPath(&#x27;userData&#x27;)</code> 下是否有 <code>lock</code> 文件。</p><h3 id="通过命令行启动"><a aria-hidden="true" href="#通过命令行启动"><span class="icon icon-link"></span></a>通过命令行启动</h3><p>命令行执行 <code>/path/to/app --arg1 value1 --arg2 value2 document/path</code>，会在应用启动的时候，通过 <code>process.argv</code> 和 <code>process.cwd</code>。</p><h3 id="通过-url-scheme-启动"><a aria-hidden="true" href="#通过-url-scheme-启动"><span class="icon icon-link"></span></a>通过 URL Scheme 启动</h3><p>通过 <code>app.setAsDefaultProtocolClient(&#x27;electron-test&#x27;)</code> 注册 URL Scheme，然后在 APP 事件 <code>open-url</code> 的 URL 参数获取 URL 信息：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="app-event - did-become-active
app-event - open-url - electron-test://happy?abc=eee#ii=aa
" data-status="copy"></button><div class="token-line"><span class="token plain">app-event - did-become-active</span></div><div class="token-line"><span class="token plain">app-event - open-url - electron-test://happy?abc=eee#ii=aa</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="通过拖拽到-dock-或者-tray-启动"><a aria-hidden="true" href="#通过拖拽到-dock-或者-tray-启动"><span class="icon icon-link"></span></a>通过拖拽到 dock 或者 tray 启动</h3><p>通过 <code>dock</code> 拖拽启动，需要在 <code>info.plist</code> 中声明支持的文件类型，比如 <code>electronBuilder</code> 可以通过 <code>extendInfo</code> 字段中，声明 <code>CFBundleDocumentTypes</code> 注册支持的类型。触发的是事件 <code>open-file</code>。</p><h2 id="参考资料"><a aria-hidden="true" href="#参考资料"><span class="icon icon-link"></span></a>参考资料</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/352668011" target="_blank" rel="noopener noreferrer">Electron 生命周期介绍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/cross-platform-guidebook/edit/master/docs/electron/application-development/launch-and-exit.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">8/4/2021, 7:57:55 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/cross-platform-guidebook/umi.js"></script>
    <script src="/cross-platform-guidebook/docs__electron__application-development__launch-and-exit.md.js"></script>
  </body>
</html>
